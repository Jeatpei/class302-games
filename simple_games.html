<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç°¡å–®éŠæˆ²å€ - å‚‘ç‰¹ä½©å°éŠæˆ²ç¶²</title>
    <style>
        :root {
            /* æ²¿ç”¨é¦–é çš„é…è‰²ç³»çµ± */
            --primary: #FF9800; /* æ´»åŠ›æ©˜ - æœ¬å€ä¸»è‰² */
            --dark: #37474F;
            --light: #ECEFF1;
            --danger: #F44336;
            --success: #4CAF50;
        }

        body {
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; margin: 0; padding: 0;
            background-color: var(--light); color: var(--dark);
            user-select: none; /* é˜²æ­¢é€£é»æ™‚é¸å–æ–‡å­— */
            overflow: hidden; /* éŠæˆ²ä¸­ç¦æ­¢æ²å‹• */
        }

        /* å°èˆªåˆ— (ç¸®å°ç‰ˆ) */
        header {
            background: var(--primary); color: white; padding: 10px;
            text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: relative;
        }
        .home-btn {
            position: absolute; left: 15px; top: 50%; transform: translateY(-50%);
            text-decoration: none; color: white; font-weight: bold; font-size: 1.2rem;
            background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 20px;
        }

        /* éŠæˆ²ä¸»å®¹å™¨ */
        .game-container {
            max-width: 500px; margin: 0 auto; height: calc(100vh - 60px);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* ç‹€æ…‹åˆ— */
        .hud {
            display: flex; gap: 30px; font-size: 1.5rem; font-weight: bold;
            margin-bottom: 20px; background: white; padding: 10px 30px;
            border-radius: 50px; box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }

        /* 3x3 éŠæˆ²ç›¤é¢ */
        .grid {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;
            background: #D7CCC8; padding: 15px; border-radius: 20px;
            border: 5px solid #8D6E63; box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .hole {
            width: 90px; height: 90px; background: #5D4037;
            border-radius: 50%; position: relative; overflow: hidden;
            box-shadow: inset 0 10px 10px rgba(0,0,0,0.5);
            cursor: pointer;
        }

        /* è§’è‰²æ¨£å¼ (ä½¿ç”¨ Emoji) */
        .mole {
            position: absolute; top: 100%; width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center;
            font-size: 3.5rem; transition: top 0.1s;
            pointer-events: none; /* è®“é»æ“Šäº‹ä»¶ç©¿é€åˆ° hole */
        }
        .hole.up .mole { top: 0; pointer-events: auto; cursor: pointer; }

        /* é–‹å§‹æŒ‰éˆ•å±¤ */
        #start-screen, #game-over-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: white; text-align: center;
        }
        .big-btn {
            padding: 15px 40px; font-size: 1.8rem; background: var(--primary);
            color: white; border: none; border-radius: 50px; cursor: pointer;
            margin-top: 20px; box-shadow: 0 5px 0 #E65100; font-weight: bold;
            transition: 0.1s;
        }
        .big-btn:active { transform: translateY(5px); box-shadow: none; }

        /* ç‰¹æ•ˆå‹•ç•« */
        @keyframes popScore { 0% {transform:scale(1); opacity:1;} 100% {transform:scale(2); opacity:0;} }
        .score-popup {
            position: absolute; font-weight: bold; font-size: 2rem;
            color: #FFD700; text-shadow: 2px 2px 0 #000;
            pointer-events: none; animation: popScore 0.5s forwards;
        }
    </style>
</head>
<body>

<header>
    <a href="index.html" class="home-btn">ğŸ  å›é¦–é </a>
    <h2 style="margin:0;">ğŸ¹ ç˜‹ç‹‚æ‰“åœ°é¼ </h2>
</header>

<div class="game-container">
    <div class="hud">
        <div style="color:var(--primary);">åˆ†æ•¸: <span id="score">0</span></div>
        <div style="color:var(--dark);">æ™‚é–“: <span id="time">30</span></div>
    </div>

    <div class="grid">
        <div class="hole" id="h1" onclick="whack(1)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h2" onclick="whack(2)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h3" onclick="whack(3)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h4" onclick="whack(4)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h5" onclick="whack(5)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h6" onclick="whack(6)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h7" onclick="whack(7)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h8" onclick="whack(8)"><div class="mole">ğŸ¹</div></div>
        <div class="hole" id="h9" onclick="whack(9)"><div class="mole">ğŸ¹</div></div>
    </div>
</div>

<div id="start-screen">
    <h1>ğŸ§© åæ‡‰å¤§æŒ‘æˆ°</h1>
    <p style="font-size:1.2rem; color:#ddd; margin:10px 0 30px;">
        çœ‹åˆ° ğŸ¹ é»ä¸‹å» (+10åˆ†)<br>
        çœ‹åˆ° ğŸ’£ ä¸è¦é» (-5åˆ†)
    </p>
    <button class="big-btn" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
</div>

<div id="game-over-screen" style="display:none;">
    <h1 style="color:var(--primary);">æ™‚é–“åˆ°ï¼</h1>
    <h2 style="font-size:3rem; margin:10px 0;">å¾—åˆ†: <span id="final-score">0</span></h2>
    <p id="comment" style="color:#ddd; margin-bottom:20px;">è©•èªè¼‰å…¥ä¸­...</p>
    <button class="big-btn" onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
    <br>
    <a href="index.html" style="color:white; margin-top:20px; display:inline-block;">å›é¦–é é¸å–®</a>
</div>

<script>
    let score = 0;
    let timeLeft = 30;
    let timerId = null;
    let moleTimer = null;
    let lastHole = null;
    let isPlaying = false;

    // éŠæˆ²åƒæ•¸
    const minSpeed = 400; // åœ°é¼ å‡ºç¾çš„æœ€çŸ­æ™‚é–“ (æ¯«ç§’)
    const maxSpeed = 1000; // åœ°é¼ å‡ºç¾çš„æœ€é•·æ™‚é–“

    function randomTime(min, max) {
        return Math.round(Math.random() * (max - min) + min);
    }

    function randomHole(holes) {
        const idx = Math.floor(Math.random() * holes.length);
        const hole = holes[idx];
        if (hole === lastHole) return randomHole(holes);
        lastHole = hole;
        return hole;
    }

    function peep() {
        if(!isPlaying) return;
        const holes = document.querySelectorAll('.hole');
        const hole = randomHole(holes);
        const time = randomTime(minSpeed, maxSpeed);
        
        // 15% æ©Ÿç‡å‡ºç¾ç‚¸å½ˆ
        const isBomb = Math.random() > 0.85;
        const mole = hole.querySelector('.mole');
        
        // è¨­å®šè§’è‰²
        mole.innerText = isBomb ? 'ğŸ’£' : 'ğŸ¹';
        hole.dataset.type = isBomb ? 'bomb' : 'hamster';

        hole.classList.add('up');

        setTimeout(() => {
            hole.classList.remove('up');
            if (isPlaying) peep();
        }, time);
    }

    function startGame() {
        score = 0;
        timeLeft = 30;
        isPlaying = true;
        document.getElementById('score').innerText = 0;
        document.getElementById('time').innerText = 30;
        document.getElementById('start-screen').style.display = 'none';
        
        peep(); // é–‹å§‹å†’åœ°é¼ 

        // å€’æ•¸è¨ˆæ™‚
        timerId = setInterval(() => {
            timeLeft--;
            document.getElementById('time').innerText = timeLeft;
            if (timeLeft <= 0) {
                gameOver();
            }
        }, 1000);
    }

    function whack(id) {
        const hole = document.getElementById('h' + id);
        if (!hole.classList.contains('up')) return; // æ²’å†’å‡ºä¾†ä¸èƒ½æ‰“

        // åˆ¤æ–·æ‰“åˆ°ä»€éº¼
        const type = hole.dataset.type;
        let points = 0;

        if (type === 'hamster') {
            points = 10;
            hole.querySelector('.mole').innerText = 'ğŸ’¥'; // æ‰“æ“Šç‰¹æ•ˆ
        } else if (type === 'bomb') {
            points = -5;
            hole.querySelector('.mole').innerText = 'ğŸ”¥'; // çˆ†ç‚¸ç‰¹æ•ˆ
            // æ‰‹æ©Ÿéœ‡å‹•å›é¥‹ (å¦‚æœæ”¯æ´)
            if(navigator.vibrate) navigator.vibrate(200); 
        }

        score += points;
        document.getElementById('score').innerText = score;
        hole.classList.remove('up'); // æ‰“åˆ°å°±ç¸®å›å»

        // é£„åˆ†ç‰¹æ•ˆ
        showFloatingScore(hole, points);
    }

    function showFloatingScore(hole, points) {
        const el = document.createElement('div');
        el.className = 'score-popup';
        el.innerText = points > 0 ? `+${points}` : points;
        el.style.color = points > 0 ? '#FFD700' : '#FF5252';
        // è¨ˆç®—ä½ç½® (ç°¡å–®ç½®ä¸­)
        el.style.left = '30px'; 
        el.style.top = '10px';
        hole.appendChild(el);
        setTimeout(() => el.remove(), 500);
    }

    function gameOver() {
        isPlaying = false;
        clearInterval(timerId);
        document.getElementById('game-over-screen').style.display = 'flex';
        document.getElementById('final-score').innerText = score;
        
        // è©•èªç³»çµ±
        let comment = "";
        if(score >= 200) comment = "å¤ªç¥å•¦ï¼ä½ çš„æ‰‹é€Ÿè·Ÿé–ƒé›»ä¸€æ¨£å¿«ï¼âš¡";
        else if(score >= 100) comment = "è¡¨ç¾ä¸éŒ¯ï¼åæ‡‰å¾ˆå¿«å–”ï¼ğŸ‘";
        else if(score >= 50) comment = "å†æ¥å†å²ï¼å°å¿ƒä¸è¦ç‚¸åˆ°æ‰‹ï¼ğŸ–ï¸";
        else comment = "åŠ æ²¹åŠ æ²¹ï¼ä¸‹æ¬¡ä¸€å®šæœƒæ›´å¥½ï¼ğŸ˜Š";
        document.getElementById('comment').innerText = comment;
    }
</script>

</body>
</html>