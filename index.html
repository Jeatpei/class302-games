<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç­ç´šç·šä¸ŠéŠæ¨‚å ´ (æ™ºæ…§é€£å‹•ç‰ˆ)</title>
    <style>
        :root { --bg: #FFF3E0; --card-bg: #fff; }
        body { font-family: 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background-color: var(--bg); margin: 0; padding: 20px; text-align: center; }
        
        header { margin-bottom: 40px; }
        h1 { color: #E65100; margin: 0; font-size: 2.5rem; text-shadow: 2px 2px 0px rgba(255,255,255,0.5); }
        .loading { font-size: 1.5rem; color: #795548; font-weight: bold; margin-top: 50px; }

        /* ç§‘ç›®å€å¡Š */
        .subject-section { 
            background: white; border-radius: 20px; padding: 25px; margin: 0 auto 30px auto; 
            max-width: 900px; box-shadow: 0 8px 20px rgba(0,0,0,0.05); text-align: left;
        }
        
        .subject-title { 
            font-size: 1.6rem; font-weight: bold; margin-bottom: 20px; display: inline-block; 
            padding: 8px 25px; border-radius: 50px; color: white; background: #555;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        /* è‡ªå‹•é…è‰²é‚è¼¯ï¼šæ ¹æ“šç§‘ç›®åç¨±é›œæ¹Šé¡è‰² */
        .color-0 .subject-title { background: #42A5F5; } /* è— */
        .color-1 .subject-title { background: #66BB6A; } /* ç¶  */
        .color-2 .subject-title { background: #AB47BC; } /* ç´« */
        .color-3 .subject-title { background: #FF7043; } /* æ©˜ */

        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }

        .game-card {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 130px; border-radius: 15px; cursor: pointer; transition: 0.2s; text-decoration: none;
            background: #fafafa; border: 2px solid #eee; color: #555; font-weight: bold; font-size: 1.1rem;
        }
        .game-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.15); border-color: #aaa; }
        .game-card .icon { font-size: 2.5rem; margin-bottom: 8px; }

        footer { margin-top: 50px; color: #aaa; font-size: 0.9rem; }
    </style>
</head>
<body>

    <header>
        <h1>ğŸ® å¿«æ¨‚å­¸ç¿’éŠæ¨‚å ´</h1>
        <p>è³‡æ–™ä¾†æºï¼šGoogle è©¦ç®—è¡¨è‡ªå‹•åŒæ­¥</p>
    </header>

    <div id="app">
        <div class="loading">â³ æ­£åœ¨å¾é›²ç«¯è®€å–éŠæˆ²åˆ—è¡¨...</div>
    </div>

    <footer>Designed for Class</footer>

<script>
    // =========================================================================
    // ğŸ”´ è€å¸«è«‹æ”¹é€™è£¡ï¼šè«‹æŠŠä¸‹æ–¹çš„ç¶²å€ï¼Œæ›æˆæ‚¨ Google è©¦ç®—è¡¨ç™¼å¸ƒçš„ CSV é€£çµ
    // =========================================================================
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQk5aCQUCeMnJBP0NLh0QfN9p0vFdEkaxiYZAGE1zFqTRMdtTpMDRuye70O1x1wEMvlJlxmDECgjmQv/pub?output=csv"; 
    // ä¾‹å¦‚: "https://docs.google.com/spreadsheets/d/e/2PACX-xxxx/pub?output=csv"

    
    // --- ä»¥ä¸‹ç¨‹å¼ç¢¼ä¸ç”¨å‹•ï¼Œå®ƒæœƒè‡ªå‹•æ¬é‹è³‡æ–™ ---
    async function loadGames() {
        const app = document.getElementById('app');
        
        try {
            const response = await fetch(sheetUrl);
            if (!response.ok) throw new Error("è®€å–å¤±æ•—");
            const text = await response.text();
            
            // è§£æ CSV
            const rows = text.split(/\r\n|\n/).slice(1); // å»æ‰æ¨™é¡Œåˆ—
            const data = {}; // ä¾ç§‘ç›®åˆ†çµ„ { "æ•¸å­¸å€": [...], "åœ‹èªå€": [...] }
            const subjects = []; // ç´€éŒ„ç§‘ç›®é †åº

            rows.forEach(row => {
                // åˆ†å‰²æ¬„ä½ (ç°¡å–®è™•ç†é€—è™Ÿ)
                const cols = row.split(','); 
                if (cols.length < 3) return; 

                const subj = cols[0].trim(); // ç§‘ç›®
                const name = cols[1].trim(); // éŠæˆ²å
                const file = cols[2].trim(); // é€£çµ
                const icon = cols[3] ? cols[3].trim() : "ğŸ®"; // åœ–ç¤º

                if (!subj || !name) return;

                if (!data[subj]) {
                    data[subj] = [];
                    subjects.push(subj);
                }
                data[subj].push({ name, file, icon });
            });

            // é–‹å§‹ç¹ªè£½ç¶²é 
            app.innerHTML = ""; // æ¸…é™¤è¼‰å…¥ä¸­æ–‡å­—
            
            if (subjects.length === 0) {
                app.innerHTML = "<div class='loading'>è©¦ç®—è¡¨è£¡å¥½åƒæ²’æœ‰è³‡æ–™å–”ï¼Ÿ<br>è«‹æª¢æŸ¥æ˜¯å¦å·²è¼¸å…¥ä¸¦ç™¼å¸ƒã€‚</div>";
                return;
            }

            subjects.forEach((subj, index) => {
                const section = document.createElement('div');
                // è¼ªæµåˆ†é…é¡è‰²æ¨£å¼ color-0 ~ color-3
                section.className = `subject-section color-${index % 4}`;
                
                const gridHtml = data[subj].map(g => `
                    <a href="${g.file}" target="_blank" class="game-card">
                        <span class="icon">${g.icon}</span>
                        ${g.name}
                    </a>
                `).join('');

                section.innerHTML = `
                    <div class="subject-title">${subj}</div>
                    <div class="games-grid">${gridHtml}</div>
                `;
                app.appendChild(section);
            });

        } catch (error) {
            console.error(error);
            app.innerHTML = `<div class="loading" style="color:red">âš ï¸ è®€å–å¤±æ•—<br>è«‹æª¢æŸ¥ index.html è£¡çš„è©¦ç®—è¡¨é€£çµæ˜¯å¦æ­£ç¢º<br>æˆ–æ˜¯è©¦ç®—è¡¨æ˜¯å¦å·²ã€Œç™¼å¸ƒåˆ°ç¶²è·¯(CSV)ã€</div>`;
        }
    }

    // å•Ÿå‹•è®€å–
    loadGames();
</script>

</body>
</html>