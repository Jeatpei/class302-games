<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ«è–©åˆ‡åˆ‡æ¨‚ï¼šåˆ†æ•¸åŠ æ¸›å¤§æŒ‘æˆ°</title>
    <style>
        body { font-family: 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; background-color: #f0f8ff; text-align: center; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        h1 { color: #ff6b6b; margin-bottom: 10px; }
        .score-board { font-size: 1.2rem; color: #555; margin-bottom: 20px; }
        .game-area { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 40px 0; flex-wrap: wrap; }
        .fraction-box { display: flex; flex-direction: column; align-items: center; }
        .visual { width: 120px; height: 120px; border-radius: 50%; background: #ddd; position: relative; border: 4px solid #333; }
        .operator { font-size: 3rem; font-weight: bold; color: #333; }
        .fraction-text { font-size: 2rem; margin-top: 10px; font-weight: bold; color: #2c3e50; }
        
        /* ç¹ªè£½åœ“é¤…åœ–çš„ CSS æŠ€å·§ */
        .pie { width: 100%; height: 100%; border-radius: 50%; background: conic-gradient(orange 0% 0%, white 0% 100%); }
        
        .answer-section { margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 15px; }
        input { width: 60px; height: 50px; font-size: 1.5rem; text-align: center; border: 2px solid #ccc; border-radius: 10px; }
        .btn { padding: 10px 30px; font-size: 1.2rem; background-color: #4CAF50; color: white; border: none; border-radius: 50px; cursor: pointer; transition: 0.3s; margin-left: 10px; }
        .btn:hover { background-color: #45a049; transform: scale(1.05); }
        .btn-new { background-color: #2196F3; display: none; margin-top: 20px; }
        
        #message { margin-top: 20px; font-size: 1.5rem; font-weight: bold; min-height: 40px; }
        .correct { color: green; }
        .wrong { color: red; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ• æŠ«è–©åˆ‡åˆ‡æ¨‚ï¼šåˆ†æ•¸å¤§æŒ‘æˆ°</h1>
    <div class="score-board">
        é€£çºŒç­”å°ï¼š<span id="streak">0</span> é¡Œ | 
        ç¸½åˆ†ï¼š<span id="score">0</span>
    </div>

    <div class="game-area">
        <div class="fraction-box">
            <div class="visual"><div id="pie1" class="pie"></div></div>
            <div class="fraction-text" id="frac1">2/8</div>
        </div>

        <div class="operator" id="operator">+</div>

        <div class="fraction-box">
            <div class="visual"><div id="pie2" class="pie"></div></div>
            <div class="fraction-text" id="frac2">3/8</div>
        </div>

        <div class="operator">=</div>

        <div class="fraction-box">
            <div class="visual" style="border: 4px dashed #aaa; background: transparent;">
                <div id="pieAnswer" class="pie" style="opacity: 0.5;"></div>
            </div>
            <div class="fraction-text">
                <input type="number" id="ansNum" placeholder="?">
                <hr style="width: 50px; border: 2px solid #333; margin: 5px 0;">
                <span id="ansDenom">8</span>
            </div>
        </div>
    </div>

    <div class="answer-section">
        <button class="btn" onclick="checkAnswer()">é€å‡ºç­”æ¡ˆ</button>
        <button class="btn btn-new" id="nextBtn" onclick="initGame()">ä¸‹ä¸€é¡Œ</button>
        <div id="message"></div>
    </div>
</div>

<script>
    let currentNum1, currentNum2, currentDenom, isAddition;
    let score = 0;
    let streak = 0;

    function initGame() {
        // é‡ç½®ä»‹é¢
        document.getElementById('message').innerHTML = "";
        document.getElementById('ansNum').value = "";
        document.getElementById('nextBtn').style.display = "none";
        document.getElementById('pieAnswer').style.background = "none";

        // éš¨æ©Ÿç”Ÿæˆåˆ†æ¯ (4, 5, 6, 8, 10, 12) - é©åˆ3å¹´ç´šçš„å¸¸è¦‹åˆ†æ¯
        const denoms = [4, 5, 6, 8, 10, 12];
        currentDenom = denoms[Math.floor(Math.random() * denoms.length)];
        
        // æ›´æ–°ç­”æ¡ˆå€çš„åˆ†æ¯é¡¯ç¤º
        document.getElementById('ansDenom').innerText = currentDenom;

        // æ±ºå®šåŠ æ³•æˆ–æ¸›æ³•
        isAddition = Math.random() > 0.5;
        document.getElementById('operator').innerText = isAddition ? "+" : "-";

        // ç”Ÿæˆåˆ†å­
        if (isAddition) {
            // åŠ æ³•ï¼šç¸½å’Œä¸èƒ½è¶…é 1 (çœŸåˆ†æ•¸)
            currentNum1 = Math.floor(Math.random() * (currentDenom - 2)) + 1;
            let maxNum2 = currentDenom - currentNum1;
            currentNum2 = Math.floor(Math.random() * maxNum2) + 1;
        } else {
            // æ¸›æ³•ï¼šç¬¬ä¸€å€‹æ•¸è¦å¤§æ–¼ç¬¬äºŒå€‹æ•¸
            currentNum1 = Math.floor(Math.random() * (currentDenom - 1)) + 1;
            // ç¢ºä¿ num1 è¶³å¤ å¤§ï¼Œèƒ½è¢«æ¸›
            if(currentNum1 < 2) currentNum1 = 2; 
            currentNum2 = Math.floor(Math.random() * (currentNum1 - 1)) + 1;
        }

        // æ›´æ–°æ–‡å­—é¡¯ç¤º
        document.getElementById('frac1').innerHTML = `<sup>${currentNum1}</sup>&frasl;<sub>${currentDenom}</sub>`;
        document.getElementById('frac2').innerHTML = `<sup>${currentNum2}</sup>&frasl;<sub>${currentDenom}</sub>`;

        // æ›´æ–°åœ–å½¢ (CSS Conic Gradient)
        drawPie('pie1', currentNum1, currentDenom, '#ff9f43');
        drawPie('pie2', currentNum2, currentDenom, '#54a0ff');
    }

    function drawPie(elementId, num, denom, color) {
        const percent = (num / denom) * 100;
        document.getElementById(elementId).style.background = 
            `conic-gradient(${color} 0% ${percent}%, white ${percent}% 100%)`;
    }

    function checkAnswer() {
        const userAns = parseInt(document.getElementById('ansNum').value);
        let correctAns;

        if (isAddition) {
            correctAns = currentNum1 + currentNum2;
        } else {
            correctAns = currentNum1 - currentNum2;
        }

        const msgDiv = document.getElementById('message');
        
        if (userAns === correctAns) {
            score += 10;
            streak++;
            msgDiv.innerHTML = "ğŸ‰ ç­”å°äº†ï¼å¤ªæ£’äº†ï¼";
            msgDiv.className = "correct";
            // é¡¯ç¤ºæ­£ç¢ºåœ–å½¢
            drawPie('pieAnswer', correctAns, currentDenom, '#2ed573');
            document.getElementById('nextBtn').style.display = "inline-block";
        } else {
            streak = 0;
            msgDiv.innerHTML = `ğŸ˜… å“å‘€ï¼Œå†è©¦è©¦çœ‹ï¼<br>æç¤ºï¼šåˆ†æ¯æ˜¯ ${currentDenom}ï¼Œåªè¦ç®— ${currentNum1} ${isAddition ? '+' : '-'} ${currentNum2} å–”ï¼`;
            msgDiv.className = "wrong";
        }

        // æ›´æ–°åˆ†æ•¸æ¿
        document.getElementById('score').innerText = score;
        document.getElementById('streak').innerText = streak;
    }

    // åˆå§‹åŒ–éŠæˆ²
    initGame();
</script>

</body>
</html>